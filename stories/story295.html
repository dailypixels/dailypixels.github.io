<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Whispering Halls of Aranor</title>
  <link rel="stylesheet" href="../style.css" />
</head>
<body>
  <a class="back-link" href="../index.html">‚Üê Back to Stories</a>
  <article class="story-page">
    <header class="story-header">
      <h1>The Whispering Halls of Aranor</h1>
      <p class="meta">October 20, 2025 ‚Ä¢ Lira Edevane</p>
      <div class="tags">
        <span class="tag">Fantasy</span>
        <span class="tag">Magic</span>
        <span class="tag">Academy</span>
        <span class="tag">Destiny</span>
        <span class="tag">Friendship</span>
      </div>
      <img class="featured-image" src="https://media.istockphoto.com/id/2224049140/photo/medieval-gothic-castle-hallway-lit-by-burning-candles-3d-render.webp?a=1&b=1&s=612x612&w=0&k=20&c=tp0QrniWtAayj8w4BtLBAWvNv4-NJWlkoqVqZdKbHaQ=" alt="Ancient magical academy hall glowing with golden runes and floating candles.">
    </header>

    <main class="story-content">
      <p>
        The Academy of Aranor stood high above the misty cliffs, its towers etched with centuries of runes that shimmered faintly under moonlight. Inside those stone walls, the greatest young mages of the realm studied under masters who had seen ages rise and fall. To most, the academy was a place of discipline and prestige. But to Elara Thane, it was a mystery.
      </p>

      <p>
        Elara was quiet, often lost among the louder, more confident apprentices. She preferred the library to the dueling halls, scrolls to spells. But in her third year, she began to hear the whispers ‚Äî faint voices threading through the corridors at night. At first, she thought it was imagination born of exhaustion. Yet the voices always returned, soft and rhythmic, echoing from the old western wing that had long been sealed.
      </p>

      <p>
        One evening, curiosity overpowered fear. Carrying a single lantern, she slipped past the curfew wards and into the forgotten passage. Dust floated like silver mist as she pushed open the creaking door to the Hall of Whispers. The air was cold, and the walls glowed faintly with dormant sigils. Then, from within the stone itself, came a voice ‚Äî clear and gentle.
      </p>

      <p>
        ‚ÄúChild of flame, the walls remember you.‚Äù 
      </p>

      <p>
        The lantern flickered. ‚ÄúWho‚Äôs there?‚Äù Elara whispered, heart racing. But the hall only sighed, and a faint golden rune lit beneath her feet ‚Äî one she recognized from her elemental studies. Fire. As she touched it, warmth spread through her palms, followed by a vision ‚Äî of the academy centuries ago, when the founders bound their magic into the walls to protect Aranor from the coming darkness.
      </p>

      <p>
        The whispers revealed fragments of that ancient spell ‚Äî one incomplete, left dormant for generations. And now, the magic was fading. Unless restored, the academy itself would crumble into the sea. Terrified but determined, Elara spent nights transcribing the runes she could hear, piecing together their pattern. She confided only in her closest friend, Kieran, a wind-mage with a knack for trouble and loyalty.
      </p>

      <p>
        Together, they followed the trail of whispers to the central tower. There, beneath the Grand Seal, they found the final rune buried under layers of enchantment. As Elara traced its pattern, the stones trembled, and the entire academy seemed to awaken. Runes flared like starlight, swirling through the air, forming words older than the realm itself.
      </p>

      <p>
        ‚ÄúYou have remembered us,‚Äù the voices said. ‚ÄúAnd so we remember you.‚Äù The final rune burned bright gold, searing warmth into Elara‚Äôs hands ‚Äî then faded into her skin like molten light. The walls fell silent. The whispers were gone.
      </p>

      <p>
        The next morning, the Masters of Aranor found her standing before the tower‚Äôs heart, eyes glowing faintly, her palms marked with the sigil of flame. The academy no longer trembled ‚Äî its foundations stronger, its halls alive once more. They called it a miracle. But Elara knew the truth ‚Äî the voices had chosen her not as a savior, but as a keeper of their memory.
      </p>

      <p>
        From that day forward, the students of Aranor said that when the halls were silent, and one listened closely enough, they could still hear Elara‚Äôs laughter echoing softly ‚Äî a whisper of the girl who had brought the academy back to life.
      </p>

      <p class="end-note">‚Äî End of Story ‚Äî</p>
    </main>

    <nav class="story-navigation">
      <a href="story294.html" class="nav-button prev">‚Üê Previous Story</a>
      <a href="story296.html" class="nav-button next">Next Story ‚Üí</a>
    </nav>
  </article>

  <script src="../js/storyFeatures.js"></script>
<style>
    body {
      font-family: 'Noto Nastaliq Urdu', serif;
      margin: 0;
      background: #fff;
    }

    /* Like + Comment Floating Buttons */
    .floating-buttons {
      position: fixed;
      bottom: 22px;
      right: 20px;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 12px;
      z-index: 1000;
    }

    .float-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ffffff;
      color: #111;
      border: 1px solid #ddd;
      border-radius: 50%;
      width: 52px;
      height: 52px;
      font-size: 1.3rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
    }

    .float-btn:hover {
      transform: scale(1.1);
      background: #f5f5f5;
    }

    .float-btn.liked {
      background: linear-gradient(90deg, #22c55e, #16a34a);
      color: white;
      box-shadow: 0 4px 12px rgba(34,197,94,0.4);
    }

    /* Like Count */
    .like-count {
      position: absolute;
      bottom: -18px;
      right: 15px;
      font-size: 0.8rem;
      color: #555;
      font-family: sans-serif;
    }

    /* Comment Popup */
    .comment-popup {
      position: fixed;
      bottom: -100%;
      left: 0;
      width: 100%;
      max-height: 85%;
      background: #fff;
      border-radius: 20px 20px 0 0;
      box-shadow: 0 -6px 20px rgba(0,0,0,0.25);
      padding: 20px;
      z-index: 2000;
      display: flex;
      flex-direction: column;
      transition: bottom 0.4s ease;
    }

    .comment-popup.active {
      bottom: 0;
    }

    .popup-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-family: sans-serif;
      font-weight: 600;
      font-size: 1.1rem;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .close-popup {
      background: none;
      border: none;
      font-size: 1.4rem;
      cursor: pointer;
      color: #666;
    }

    .comments-list {
      flex: 1;
      overflow-y: auto;
      margin-top: 15px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .comment-item {
      background: #f9fafb;
      padding: 10px 14px;
      border-radius: 12px;
      font-family: sans-serif;
      font-size: 0.95rem;
      line-height: 1.4;
      border: 1px solid #eee;
    }

    .comment-item strong {
      display: block;
      margin-bottom: 4px;
      color: #111;
      font-size: 0.95rem;
    }

    .comment-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
      border-top: 1px solid #eee;
      padding-top: 10px;
      margin-top: 12px;
    }

    .comment-form input,
    .comment-form textarea {
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 10px;
      font-family: sans-serif;
      font-size: 0.95rem;
      width: 100%;
      resize: none;
      outline: none;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .comment-form input:focus,
    .comment-form textarea:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37,99,235,0.15);
    }

    .comment-form button {
      align-self: flex-start;
      background: linear-gradient(90deg, #2563eb, #1d4ed8);
      color: white;
      border: none;
      border-radius: 40px;
      padding: 8px 22px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: all 0.3s ease;
      box-shadow: 0 2px 6px rgba(37,99,235,0.3);
    }

    .comment-form button:hover {
      transform: scale(1.05);
    }

    .comment-form button.sent {
      background: linear-gradient(90deg, #22c55e, #16a34a);
      box-shadow: 0 4px 10px rgba(34,197,94,0.4);
      cursor: default;
      transform: none;
    }

    /* Scrollbar */
    .comments-list::-webkit-scrollbar {
      width: 6px;
    }
    .comments-list::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 4px;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .float-btn {
        width: 48px;
        height: 48px;
        font-size: 1.2rem;
      }
      .comment-popup {
        padding: 16px;
      }
    }
  </style>
<!-- Floating Like + Comment Buttons -->
  <div class="floating-buttons">
    <div style="position: relative;">
      <button class="float-btn" id="likeBtn">‚ù§Ô∏è</button>
      <span class="like-count" id="likeCount">0</span>
    </div>
    <button class="float-btn" id="commentBtn">üí¨</button>
  </div>

  <!-- Comment Popup -->
  <div class="comment-popup" id="commentPopup">
    <div class="popup-header">
      <span>Comments</span>
      <button class="close-popup" id="closePopup">‚úï</button>
    </div>

    <div class="comments-list" id="commentsList"></div>

    <form class="comment-form" action="https://formspree.io/f/xkgvkele" method="POST" id="commentForm">
      <input type="text" id="name" name="name" placeholder="Your name" required />
      <textarea id="comment" name="comment" placeholder="Write a comment..." required></textarea>
      <button type="submit" id="sendBtn">Send</button>
    </form>
  </div>

<script>
    /* ---------------- LIKE SYSTEM ---------------- */
    const likeBtn = document.getElementById("likeBtn");
    const likeCount = document.getElementById("likeCount");

    const storyKey = location.pathname.split("/").pop();
    const likedKey = `liked_${storyKey}`;
    const countKey = `likeCount_${storyKey}`;

    let liked = localStorage.getItem(likedKey) === "true";
    let count = parseInt(localStorage.getItem(countKey));

    if (isNaN(count)) {
      count = Math.floor(15 + Math.random() * 50);
      localStorage.setItem(countKey, count);
    }

    updateLikeUI();

    likeBtn.addEventListener("click", () => {
      liked = !liked;
      count = liked ? count + 1 : Math.max(0, count - 1);
      localStorage.setItem(likedKey, liked);
      localStorage.setItem(countKey, count);
      updateLikeUI();
    });

    function updateLikeUI() {
      likeBtn.classList.toggle("liked", liked);
      likeCount.textContent = count;
    }

    /* ---------------- COMMENT POPUP ---------------- */
    const commentBtn = document.getElementById("commentBtn");
    const commentPopup = document.getElementById("commentPopup");
    const closePopup = document.getElementById("closePopup");
    const commentsList = document.getElementById("commentsList");
    const commentForm = document.getElementById("commentForm");
    const sendBtn = document.getElementById("sendBtn");

    commentBtn.addEventListener("click", () => {
      commentPopup.classList.add("active");
    });

    closePopup.addEventListener("click", () => {
      commentPopup.classList.remove("active");
    });

    /* Load saved comments */
    const commentsKey = `comments_${storyKey}`;
    let comments = JSON.parse(localStorage.getItem(commentsKey)) || [];
    renderComments();

    function renderComments() {
      commentsList.innerHTML = comments.length
        ? comments.map(c => `<div class="comment-item"><strong>${c.name}</strong>${c.text}</div>`).join("")
        : `<p style="color:#777;font-family:sans-serif;font-size:0.9rem;">No comments yet.</p>`;
    }

    /* Submit comment */
    commentForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value.trim();
      const text = document.getElementById("comment").value.trim();
      if (!name || !text) return;

      // Save locally
      comments.push({ name, text });
      localStorage.setItem(commentsKey, JSON.stringify(comments));
      renderComments();

      // Send to Formspree
      const formData = new FormData(commentForm);
      const action = commentForm.getAttribute("action");

      try {
        const res = await fetch(action, { method: "POST", body: formData, headers: { 'Accept': 'application/json' } });
        if (res.ok) {
          sendBtn.textContent = "Sent ‚úÖ";
          sendBtn.classList.add("sent");
          sendBtn.disabled = true;
          commentForm.reset();
          setTimeout(() => {
            sendBtn.textContent = "Send";
            sendBtn.classList.remove("sent");
            sendBtn.disabled = false;
          }, 2000);
        }
      } catch {
        alert("Connection failed. Please try again.");
      }
    });
  </script>
  <footer class="site-footer">
    <p>¬© <span id="year"></span> Daily Pixel. All rights reserved.</p>
  </footer>
</body>
</html>
