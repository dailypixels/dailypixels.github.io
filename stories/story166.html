<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The City Beneath the Canopy</title>
  <link rel="stylesheet" href="../style.css" />
</head>
<body>
  <a class="back-link" href="../index.html">‚Üê Back to Stories</a>
  <article class="story-page">
    <header class="story-header">
      <h1>The City Beneath the Canopy</h1>
      <p class="meta">October 18, 2025 ‚Ä¢ By Mara Ellison</p>
      <div class="tags">
        <span class="tag">lost city</span>
        <span class="tag">ruins</span>
        <span class="tag">discovery</span>
      </div>
      <img class="featured-image" src="https://media.istockphoto.com/id/891658046/photo/temple-ruins-in-the-jungle-near-angkor-wat-in-cambodia.webp?a=1&b=1&s=612x612&w=0&k=20&c=X4MRhROgHhNBPfk3R2sIrgCwL2UTtHQoU6BxPbqM-z4=" alt="A misty ancient stone city hidden deep in a dense jungle, sunlight filtering through the canopy.">
    </header>

    <main class="story-content">
     <p><strong>Part I: The Forgotten Map</strong></p>

<p>Lila Moreno wiped the sweat from her brow as she unfolded the ancient parchment. The map, brittle with age, hinted at a city hidden deep beneath the jungle canopy ‚Äî a civilization erased from all history books. Many had tried to find it, none had returned.</p>

<p>‚ÄúIt‚Äôs impossible,‚Äù muttered her colleague, Javier, peering over her shoulder. ‚ÄúNo one‚Äôs been this deep. The last expedition‚Ä¶ vanished.‚Äù</p>

<p>But Lila‚Äôs eyes sparkled. ‚ÄúThen we‚Äôll be the first to return with proof.‚Äù</p>

<hr>

<p><strong>Part II: Into the Green Labyrinth</strong></p>

<p>They hacked through thick vines, crossed treacherous rivers, and avoided sinkholes concealed beneath moss and leaf litter. The jungle seemed alive, whispering warnings. At night, the canopy above allowed only shards of moonlight, and strange calls echoed through the shadows.</p>

<p>Days passed, and just when hope waned, they stumbled upon a wall carved from enormous stones, hidden beneath centuries of vines. Symbols ‚Äî unknown and intricate ‚Äî adorned the surface. Lila‚Äôs heart pounded. The city was real.</p>

<hr>

<p><strong>Part III: The Heart of the City</strong></p>

<p>As they followed crumbling streets, Lila and Javier uncovered towering temples, plazas overrun by roots, and statues whose eyes seemed almost alive. Every corner held fragments of a culture lost: pottery, murals, and intricate metalwork.</p>

<p>In the central plaza, a massive stone doorway beckoned, engraved with a warning: <em>"Only those with hearts unburdened may awaken the city‚Äôs secret."</em></p>

<p>Javier hesitated. ‚ÄúDo we dare?‚Äù</p>

<p>Lila took a deep breath. ‚ÄúIf we don‚Äôt, history dies here.‚Äù</p>

<p>They pushed the doorway open, revealing an inner sanctum illuminated by shafts of sunlight piercing cracks above. At its center lay a crystal sphere, pulsing faintly with light, suspended above a pedestal covered in moss. Lila reached out and touched it ‚Äî and the city trembled, as if waking from a centuries-long slumber.</p>

<hr>

<p><strong>Part IV: The Secret Revealed</strong></p>

<p>Images flickered in the air ‚Äî visions of the people who had once thrived here, their lives, their celebrations, their downfall. They had harnessed knowledge of the stars, of the earth, of the very pulse of life ‚Äî and then vanished, leaving behind only this sanctuary. The sphere contained everything they had learned.</p>

<p>‚ÄúWe must share this,‚Äù whispered Lila, tears glistening in her eyes. ‚ÄúThe world needs to remember them.‚Äù</p>

<p>As they exited, the jungle seemed different ‚Äî protective, almost reverent. The lost city receded into green shadows, awaiting the next explorers with unburdened hearts.</p>

<hr>

<p><strong>Meaning / Reflection:</strong><br>
<em>The City Beneath the Canopy</em> reminds us that history and knowledge often hide in places we least expect. Courage, curiosity, and respect for the past allow us to uncover truths that can inspire generations. Adventure isn‚Äôt just about discovery ‚Äî it‚Äôs about carrying forward the wisdom of those who came before us. üåøüèõÔ∏è</p>


      <p class="end-note">‚Äî End of Story ‚Äî</p>
    </main>

    <nav class="story-navigation">
      <a href="story165.html" class="nav-button prev">‚Üê Previous Story</a>
      <a href="story167.html" class="nav-button next">Next Story ‚Üí</a>
    </nav>
  </article>
<script src="../js/storyFeatures.js"></script>
<style>
    body {
      font-family: 'Noto Nastaliq Urdu', serif;
      margin: 0;
      background: #fff;
    }

    /* Like + Comment Floating Buttons */
    .floating-buttons {
      position: fixed;
      bottom: 22px;
      right: 20px;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 12px;
      z-index: 1000;
    }

    .float-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ffffff;
      color: #111;
      border: 1px solid #ddd;
      border-radius: 50%;
      width: 52px;
      height: 52px;
      font-size: 1.3rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
    }

    .float-btn:hover {
      transform: scale(1.1);
      background: #f5f5f5;
    }

    .float-btn.liked {
      background: linear-gradient(90deg, #22c55e, #16a34a);
      color: white;
      box-shadow: 0 4px 12px rgba(34,197,94,0.4);
    }

    /* Like Count */
    .like-count {
      position: absolute;
      bottom: -18px;
      right: 15px;
      font-size: 0.8rem;
      color: #555;
      font-family: sans-serif;
    }

    /* Comment Popup */
    .comment-popup {
      position: fixed;
      bottom: -100%;
      left: 0;
      width: 100%;
      max-height: 85%;
      background: #fff;
      border-radius: 20px 20px 0 0;
      box-shadow: 0 -6px 20px rgba(0,0,0,0.25);
      padding: 20px;
      z-index: 2000;
      display: flex;
      flex-direction: column;
      transition: bottom 0.4s ease;
    }

    .comment-popup.active {
      bottom: 0;
    }

    .popup-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-family: sans-serif;
      font-weight: 600;
      font-size: 1.1rem;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .close-popup {
      background: none;
      border: none;
      font-size: 1.4rem;
      cursor: pointer;
      color: #666;
    }

    .comments-list {
      flex: 1;
      overflow-y: auto;
      margin-top: 15px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .comment-item {
      background: #f9fafb;
      padding: 10px 14px;
      border-radius: 12px;
      font-family: sans-serif;
      font-size: 0.95rem;
      line-height: 1.4;
      border: 1px solid #eee;
    }

    .comment-item strong {
      display: block;
      margin-bottom: 4px;
      color: #111;
      font-size: 0.95rem;
    }

    .comment-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
      border-top: 1px solid #eee;
      padding-top: 10px;
      margin-top: 12px;
    }

    .comment-form input,
    .comment-form textarea {
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 10px;
      font-family: sans-serif;
      font-size: 0.95rem;
      width: 100%;
      resize: none;
      outline: none;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .comment-form input:focus,
    .comment-form textarea:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37,99,235,0.15);
    }

    .comment-form button {
      align-self: flex-start;
      background: linear-gradient(90deg, #2563eb, #1d4ed8);
      color: white;
      border: none;
      border-radius: 40px;
      padding: 8px 22px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: all 0.3s ease;
      box-shadow: 0 2px 6px rgba(37,99,235,0.3);
    }

    .comment-form button:hover {
      transform: scale(1.05);
    }

    .comment-form button.sent {
      background: linear-gradient(90deg, #22c55e, #16a34a);
      box-shadow: 0 4px 10px rgba(34,197,94,0.4);
      cursor: default;
      transform: none;
    }

    /* Scrollbar */
    .comments-list::-webkit-scrollbar {
      width: 6px;
    }
    .comments-list::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 4px;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .float-btn {
        width: 48px;
        height: 48px;
        font-size: 1.2rem;
      }
      .comment-popup {
        padding: 16px;
      }
    }
  </style>
<!-- Floating Like + Comment Buttons -->
  <div class="floating-buttons">
    <div style="position: relative;">
      <button class="float-btn" id="likeBtn">‚ù§Ô∏è</button>
      <span class="like-count" id="likeCount">0</span>
    </div>
    <button class="float-btn" id="commentBtn">üí¨</button>
  </div>

  <!-- Comment Popup -->
  <div class="comment-popup" id="commentPopup">
    <div class="popup-header">
      <span>Comments</span>
      <button class="close-popup" id="closePopup">‚úï</button>
    </div>

    <div class="comments-list" id="commentsList"></div>

    <form class="comment-form" action="https://formspree.io/f/xkgvkele" method="POST" id="commentForm">
      <input type="text" id="name" name="name" placeholder="Your name" required />
      <textarea id="comment" name="comment" placeholder="Write a comment..." required></textarea>
      <button type="submit" id="sendBtn">Send</button>
    </form>
  </div>

<script>
    /* ---------------- LIKE SYSTEM ---------------- */
    const likeBtn = document.getElementById("likeBtn");
    const likeCount = document.getElementById("likeCount");

    const storyKey = location.pathname.split("/").pop();
    const likedKey = `liked_${storyKey}`;
    const countKey = `likeCount_${storyKey}`;

    let liked = localStorage.getItem(likedKey) === "true";
    let count = parseInt(localStorage.getItem(countKey));

    if (isNaN(count)) {
      count = Math.floor(15 + Math.random() * 50);
      localStorage.setItem(countKey, count);
    }

    updateLikeUI();

    likeBtn.addEventListener("click", () => {
      liked = !liked;
      count = liked ? count + 1 : Math.max(0, count - 1);
      localStorage.setItem(likedKey, liked);
      localStorage.setItem(countKey, count);
      updateLikeUI();
    });

    function updateLikeUI() {
      likeBtn.classList.toggle("liked", liked);
      likeCount.textContent = count;
    }

    /* ---------------- COMMENT POPUP ---------------- */
    const commentBtn = document.getElementById("commentBtn");
    const commentPopup = document.getElementById("commentPopup");
    const closePopup = document.getElementById("closePopup");
    const commentsList = document.getElementById("commentsList");
    const commentForm = document.getElementById("commentForm");
    const sendBtn = document.getElementById("sendBtn");

    commentBtn.addEventListener("click", () => {
      commentPopup.classList.add("active");
    });

    closePopup.addEventListener("click", () => {
      commentPopup.classList.remove("active");
    });

    /* Load saved comments */
    const commentsKey = `comments_${storyKey}`;
    let comments = JSON.parse(localStorage.getItem(commentsKey)) || [];
    renderComments();

    function renderComments() {
      commentsList.innerHTML = comments.length
        ? comments.map(c => `<div class="comment-item"><strong>${c.name}</strong>${c.text}</div>`).join("")
        : `<p style="color:#777;font-family:sans-serif;font-size:0.9rem;">No comments yet.</p>`;
    }

    /* Submit comment */
    commentForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value.trim();
      const text = document.getElementById("comment").value.trim();
      if (!name || !text) return;

      // Save locally
      comments.push({ name, text });
      localStorage.setItem(commentsKey, JSON.stringify(comments));
      renderComments();

      // Send to Formspree
      const formData = new FormData(commentForm);
      const action = commentForm.getAttribute("action");

      try {
        const res = await fetch(action, { method: "POST", body: formData, headers: { 'Accept': 'application/json' } });
        if (res.ok) {
          sendBtn.textContent = "Sent ‚úÖ";
          sendBtn.classList.add("sent");
          sendBtn.disabled = true;
          commentForm.reset();
          setTimeout(() => {
            sendBtn.textContent = "Send";
            sendBtn.classList.remove("sent");
            sendBtn.disabled = false;
          }, 2000);
        }
      } catch {
        alert("Connection failed. Please try again.");
      }
    });
  </script>
<footer class="site-footer">
  <p>¬© <span id="year"></span> Daily Pixel. All rights reserved.</p>
</footer>

</body>
</html>
